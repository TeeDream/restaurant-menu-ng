<mat-drawer-container class="sidenav-container" autosize>
  <mat-drawer #drawer class="sidenav" mode="over">
    <app-product-filtration
      (productFilters)="menuCategoriesHandler($event)"
      [isAdmin]="isAdmin"
    ></app-product-filtration>
  </mat-drawer>
  <div class="sidenav-content">
    <div *ngIf="isLoading$ | async">Loading...</div>
    <ng-container *ngIf="storeCategories$ | async as categories">
      <div *ngFor="let category of categories">
        {{category | json}}
      </div>
    </ng-container>


    <div class="search-filter-wrapper">
      <div class="spacer"></div>
      <div class="search-filter">
        <app-product-search
          (filter)="menuQueryHandler($event)"
        ></app-product-search>
        <button type="button" mat-icon-button (click)="drawer.toggle()">
          <mat-icon>filter_list</mat-icon>
        </button>
      </div>
      <div class="spacer"></div>
    </div>
    <ng-container *ngIf="isAdmin && isEditing">
      <app-create-product-btn
        [categories]="categories"
      ></app-create-product-btn>
    </ng-container>
    <ng-container *ngIf="products$ | async as products">
      <ng-container *ngFor="let category of categories">
        <ng-container *ngIf="menuFilters.filters.includes(category.id.toString())">
          <div>Category: {{ category.name | uppercase }}</div>
          <div class="product-wrapper">
            <ng-container *ngFor="let product of products">
              <app-product-item
                *ngIf="product.categoryId === category.id"
                [product]="product"
                [isAuth]="isAuth$ | async"
                [isAdmin]="isAdmin"
                [isEditing]="isEditing"
                [categories]="categories"
              >
              </app-product-item>
            </ng-container>
          </div>
        </ng-container>
      </ng-container>
    </ng-container>
  </div>
</mat-drawer-container>
